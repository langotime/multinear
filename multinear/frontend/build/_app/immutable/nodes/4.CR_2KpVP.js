import{d as S,a as t,t as v,s as xe,c as Z,e as M,b as F}from"../chunks/disclose-version.DitXKBiM.js";import{i as re}from"../chunks/legacy.DmYQQF0A.js";import{f as s,p as se,c as n,r as o,t as P,a as oe,N as Fe,s as c,n as T,g as b,u as Ce,l as De,b as Me,d as te,m as ue}from"../chunks/index-client.IJhfC0Az.js";import{l as ee,s as je,p as ae,i as x}from"../chunks/props.C-C6UnW2.js";import{C as fe,a as Ne,b as Ee,E as Te,c as Be,d as Oe}from"../chunks/ErrorDisplay.l31BTbkw.js";import{C as Ae}from"../chunks/TimeAgo.CznHqdE2.js";import{s as de,c as we,d as Pe,b as Ue,e as pe,i as me,a as _e,B as Ie}from"../chunks/index.DJ6cfu9r.js";import{I as Se,g as Ve}from"../chunks/index.tND5z-kR.js";import{c as Le,p as Ge,a as Ke,b as We}from"../chunks/projects.BHxzli0w.js";import{a as He,R as Qe}from"../chunks/RunsWithFilters.BwiRCzEI.js";import{s as $e}from"../chunks/class.CFHkN7I5.js";import{j as ke,h as Xe,P as Ye,p as Ze,e as et,a as tt}from"../chunks/jobs.u5HYNM14.js";import{a as Je}from"../chunks/Loading.Bn2EZAMG.js";function ge(h,a){const l=ee(a,["children","$$slots","$$events","$$legacy"]);Se(h,je({name:"circle-alert"},()=>l,{iconNode:[["circle",{cx:"12",cy:"12",r:"10"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16"}]],children:(u,f)=>{var r=S(),p=s(r);de(p,a,"default",{},null),t(u,r)},$$slots:{default:!0}}))}function at(h,a){const l=ee(a,["children","$$slots","$$events","$$legacy"]);Se(h,je({name:"circle-check"},()=>l,{iconNode:[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"m9 12 2 2 4-4"}]],children:(u,f)=>{var r=S(),p=s(r);de(p,a,"default",{},null),t(u,r)},$$slots:{default:!0}}))}function rt(h,a){const l=ee(a,["children","$$slots","$$events","$$legacy"]);Se(h,je({name:"circle-x"},()=>l,{iconNode:[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"m15 9-6 6"}],["path",{d:"m9 9 6 6"}]],children:(u,f)=>{var r=S(),p=s(r);de(p,a,"default",{},null),t(u,r)},$$slots:{default:!0}}))}var st=v("<div><!></div>");function be(h,a){const l=ee(a,["children","$$slots","$$events","$$legacy"]),e=ee(l,["class","variant"]);se(a,!1);let u=ae(a,"class",8,void 0),f=ae(a,"variant",8,"default");re();var r=st();let p;var y=n(r);de(y,a,"default",{},null),o(r),P(()=>p=we(r,p,{class:Pe(He({variant:f()}),u()),...e,role:"alert"})),t(h,r),oe()}var ot=v("<div><!></div>");function he(h,a){const l=ee(a,["children","$$slots","$$events","$$legacy"]),e=ee(l,["class"]);se(a,!1);let u=ae(a,"class",8,void 0);re();var f=ot();let r;var p=n(f);de(p,a,"default",{},null),o(f),P(()=>r=we(f,r,{class:Pe("text-sm [&_p]:leading-relaxed",u()),...e})),t(h,f),oe()}function ye(h,a){const l=ee(a,["children","$$slots","$$events","$$legacy"]),e=ee(l,["class","level"]);se(a,!1);let u=ae(a,"class",8,void 0),f=ae(a,"level",8,"h5");re();var r=S(),p=s(r);Ue(p,f,!1,(y,m)=>{let A;P(()=>A=we(y,A,{class:Pe("mb-1 font-medium leading-none tracking-tight",u()),...e},void 0,y.namespaceURI===Fe,y.nodeName.includes("-")));var g=S(),I=s(g);de(I,a,"default",{},null),t(m,g)}),t(h,r),oe()}var lt=v("<!> <!> <!>",1),nt=v('<div class="absolute top-0 h-4 bg-red-500"></div>'),it=v('<div class="absolute top-0 h-4 bg-yellow-500 progress-stripe svelte-i2gyqw"></div>'),dt=v('<div class="absolute top-0 h-4 bg-green-600"></div>'),ct=v('<span class="inline-flex items-center gap-1"><div></div> </span>'),vt=v('<div class="text-sm text-gray-500 flex flex-wrap gap-2"></div>'),ut=v('<div class="w-full bg-gray-200 rounded-sm h-4 dark:bg-gray-700 relative overflow-hidden"><div></div> <!></div> <div class="flex justify-between mt-1 text-sm text-gray-500"><div class="flex"><!></div> <div class="flex gap-8"><span> </span> <span> </span></div></div>',1),_t=v('<div class="mt-2"><!></div>'),$t=v("<!> <!> <!>",1),ft=v('<div class="border rounded-lg p-4 bg-gray-50"><div class="flex items-center gap-4"><span class="font-medium">Latest Run:</span> <span> </span> <span> </span></div> <!> <!></div>');function pt(h,a){se(a,!1);const l=xe(),e=()=>Z(ke,"$jobStore",l);re();var u=S(),f=s(u);x(f,()=>e().currentJob,r=>{var p=ft(),y=n(p),m=c(n(y),2),A=n(m,!0);P(()=>F(A,e().currentJob.slice(-8))),o(m);var g=c(m,2),I=n(g);o(g),o(y);var B=c(y,2);x(B,()=>e().jobDetails,H=>{var C=_t(),le=n(C);x(le,()=>(!e().jobDetails.task_status_map||Object.keys(e().jobDetails.task_status_map).length===0)&&!e().jobStatus,J=>{be(J,{variant:"destructive",class:"mt-2",children:(O,_)=>{var j=lt(),k=s(j);ge(k,{class:"h-4 w-4"});var N=c(k,2);ye(N,{children:(R,d)=>{T();var $=M("Experiment Failed");t(R,$)},$$slots:{default:!0}});var i=c(N,2);he(i,{children:(R,d)=>{T();var $=M("No task status information available. The experiment may have failed to start properly.");t(R,$)},$$slots:{default:!0}}),t(O,j)},$$slots:{default:!0}})},J=>{var O=ut(),_=s(O),j=n(_),k=c(j,2);x(k,()=>e().jobDetails.task_status_map,E=>{var w=S(),Q=s(w);pe(Q,1,()=>Object.entries(e().jobDetails.task_status_map),me,(G,z,L)=>{let q=()=>b(z)[1];var X=S(),Y=s(X);x(Y,()=>q()==="failed",K=>{var D=nt();P(()=>_e(D,"style",`width: ${100/e().jobDetails.total_tasks}%; left: ${L/e().jobDetails.total_tasks*100}%`)),t(K,D)},K=>{var D=S(),ie=s(D);x(ie,()=>q()==="evaluating",ce=>{var ve=it();P(()=>_e(ve,"style",`width: ${100/e().jobDetails.total_tasks}%; left: ${L/e().jobDetails.total_tasks*100}%`)),t(ce,ve)},ce=>{var ve=S(),ze=s(ve);x(ze,()=>q()==="completed",qe=>{var Re=dt();P(()=>_e(Re,"style",`width: ${100/e().jobDetails.total_tasks}%; left: ${L/e().jobDetails.total_tasks*100}%`)),t(qe,Re)},null,!0),t(ce,ve)},!0),t(K,D)}),t(G,X)}),t(E,w)}),o(_);var N=c(_,2),i=n(N),R=n(i);x(R,()=>e().jobDetails.task_status_map,E=>{var w=vt();pe(w,5,()=>Object.entries(e().taskStatusCounts),me,(Q,G)=>{let z=()=>b(G)[0],L=()=>b(G)[1];var q=S(),X=s(q);x(X,()=>L()>0,Y=>{var K=ct(),D=n(K),ie=c(D);o(K),P(()=>{$e(D,`w-2 h-2 rounded-full ${(z()==="completed"?"bg-green-500":z()==="running"?"bg-blue-500":z()==="evaluating"?"bg-yellow-500":z()==="failed"?"bg-red-500":"bg-gray-500")??""}`),F(ie,` ${z()??""}: ${L()??""}`)}),t(Y,K)}),t(Q,q)}),o(w),t(E,w)}),o(i);var d=c(i,2),$=n(d),U=n($);o($);var V=c($,2),ne=n(V);P(()=>{var E,w;return F(ne,`${(e().jobStatus==="completed"||e().jobStatus==="failed"?"100":Math.round((((E=e().jobDetails)==null?void 0:E.current_task)||0)/(((w=e().jobDetails)==null?void 0:w.total_tasks)||1)*100))??""}%`)}),o(V),o(d),o(N),P(()=>{var E,w;$e(j,`${`h-4 transition-all duration-300 relative overflow-hidden rounded-r-sm ${e().jobStatus==="failed"?"bg-red-500":"bg-blue-600 progress-stripe"}`??""} svelte-i2gyqw`),_e(j,"style",`width: ${(e().jobStatus==="completed"||e().jobStatus==="failed"?"100":e().jobDetails.current_task/e().jobDetails.total_tasks*100)??""}%;`),F(U,`${(((E=e().jobDetails)==null?void 0:E.current_task)||0)??""} / ${(((w=e().jobDetails)==null?void 0:w.total_tasks)||0)??""}`)}),t(J,O)}),o(C),t(H,C)});var W=c(B,2);x(W,()=>e().jobStatus==="error"||e().jobStatus==="failed",H=>{be(H,{variant:"destructive",class:"mt-2",children:(C,le)=>{var J=$t(),O=s(J);ge(O,{class:"h-4 w-4"});var _=c(O,2);ye(_,{children:(k,N)=>{T();var i=M("Run Failed");t(k,i)},$$slots:{default:!0}});var j=c(_,2);he(j,{children:(k,N)=>{var i=S(),R=s(i);x(R,()=>{var d;return(d=e().jobDetails)==null?void 0:d.error},d=>{var $=M();P(()=>F($,e().jobDetails.error)),t(d,$)},d=>{var $=M("The experiment failed to complete. Check the task details for more information.");t(d,$)}),t(k,i)},$$slots:{default:!0}}),t(C,J)},$$slots:{default:!0}})}),o(p),P(()=>{$e(g,`${`text-gray-500 ${e().jobStatus==="failed"||e().jobStatus==="error"?"text-red-500":""}`??""} svelte-i2gyqw`),F(I,`Status: ${e().jobStatus??""}`)}),t(r,p)}),t(h,u),oe()}var mt=v('<div class="flex items-center gap-2"><!> <span class="text-gray-500"> </span></div>'),gt=v("<!> Run Experiment",1),bt=v("<div><!></div>");function ht(h,a){se(a,!1);const l=xe(),e=()=>Z(ke,"$jobStore",l),u=()=>Z(Le,"$selectedProjectId",l);let f=ae(a,"reloadRecentRuns",8);re();var r=bt(),p=n(r);x(p,()=>e().currentJob&&e().jobStatus&&!["completed","failed","error"].includes(e().jobStatus),y=>{var m=mt(),A=n(m);Je(A,{class:"h-4 w-4 animate-spin"});var g=c(A,2),I=n(g,!0);o(g),o(m),P(()=>F(I,e().jobStatus)),t(y,m)},y=>{Ie(y,{variant:"primary",class:"flex items-center gap-2",$$events:{click:()=>Xe(u(),f())},children:(m,A)=>{var g=gt(),I=s(g);Ye(I,{class:"h-4 w-4"}),T(),t(m,g)},$$slots:{default:!0}})}),o(r),t(h,r),oe()}var yt=v("<!> <!> <!>",1),xt=v("<!> <!>",1);function jt(h,a){se(a,!1);let l=ae(a,"alerts",24,()=>[]);re();var e=S(),u=s(e);x(u,()=>l().length>0,f=>{fe(f,{children:(r,p)=>{var y=xt(),m=s(y);Ne(m,{children:(g,I)=>{Ee(g,{children:(B,W)=>{T();var H=M("Key Alerts and Notifications");t(B,H)},$$slots:{default:!0}})},$$slots:{default:!0}});var A=c(m,2);Ae(A,{class:"space-y-4",children:(g,I)=>{var B=S(),W=s(B);pe(W,1,l,me,(H,C)=>{var le=Ce(()=>b(C).type==="improvement"?"default":"destructive");be(H,{get variant(){return b(le)},children:(J,O)=>{var _=yt(),j=s(_);x(j,()=>b(C).type==="regression",i=>{ge(i,{class:"h-4 w-4"})},i=>{var R=S(),d=s(R);x(d,()=>b(C).type==="security",$=>{rt($,{class:"h-4 w-4"})},$=>{var U=S(),V=s(U);x(V,()=>b(C).type==="improvement",ne=>{at(ne,{class:"h-4 w-4"})},null,!0),t($,U)},!0),t(i,R)});var k=c(j,2);ye(k,{children:(i,R)=>{T();var d=M();P(()=>F(d,b(C).type.charAt(0).toUpperCase()+b(C).type.slice(1))),t(i,d)},$$slots:{default:!0}});var N=c(k,2);he(N,{children:(i,R)=>{T();var d=M();P(()=>F(d,b(C).message)),t(i,d)},$$slots:{default:!0}}),t(J,_)},$$slots:{default:!0}})}),t(g,B)},$$slots:{default:!0}}),t(r,y)},$$slots:{default:!0}})}),t(h,e),oe()}var wt=v('<div class="flex items-center justify-center h-[50vh] text-gray-500"><div class="flex items-center gap-2"><!> <span>Loading project details...</span></div></div>'),Pt=v('<div class="flex items-center justify-center h-[50vh] text-gray-500"><!></div>'),St=v("<!> <!>",1),kt=v("<!> <!>",1),Rt=v('<div class="flex items-center justify-center h-[50vh] text-gray-500"><!></div>'),Dt=v('<span class="text-md font-medium">Total Runs</span> <div class="text-2xl font-bold"> </div>',1),Ct=v('<div class="flex justify-between items-center"><h1 class="text-3xl font-bold -mb-2 -mt-2"> </h1> <!></div> <!> <div class="grid grid-cols-1 md:grid-cols-3 gap-4"><!></div> <!> <!>',1),Nt=v('<div class="container mx-auto p-4 space-y-6"><!></div>');function Vt(h,a){se(a,!1);const l=xe(),e=()=>Z(We,"$projects",l),u=()=>Z(Le,"$selectedProjectId",l),f=()=>Z(ke,"$jobStore",l),r=()=>Z(tt,"$pendingRunStore",l),p=()=>Z(Ge,"$projectsLoading",l),y=()=>Z(Ke,"$projectsError",l),m=ue();let A=ue([]),g=ue(null),I=ue(!1),B=ue(0);async function W(){te(I,!0),te(g,null);try{const _=await Ve(u());te(A,_.runs),te(B,_.total)}catch(_){console.error("Error loading recent runs:",_),te(g,_ instanceof Error?_.message:"Unknown error")}finally{te(I,!1)}}async function H(){f().currentJob&&f().jobStatus&&!["completed","failed","error"].includes(f().jobStatus)&&await Ze(u(),f().currentJob,W)}async function C(){r()&&await et(W)}const le=[];De(()=>(e(),u()),()=>{te(m,e().find(_=>_.id===u()))}),De(()=>b(m),()=>{b(m)&&(W(),H(),C())}),Me(),re();var J=Nt(),O=n(J);x(O,p,_=>{var j=wt(),k=n(j),N=n(k);Je(N,{class:"h-6 w-6 animate-spin"}),T(2),o(k),o(j),t(_,j)},_=>{var j=S(),k=s(j);x(k,y,N=>{var i=Pt(),R=n(i),d=Ce(()=>`${y()} - Check if API is running`);Te(R,{get errorMessage(){return b(d)},onRetry:()=>window.location.reload(),className:"w-96"}),o(i),t(N,i)},N=>{var i=S(),R=s(i);x(R,()=>!b(m),d=>{var $=Rt(),U=n($);fe(U,{class:"border-yellow-200 bg-yellow-50 w-96 space-y-4",children:(V,ne)=>{var E=kt(),w=s(E);Ne(w,{children:(G,z)=>{var L=St(),q=s(L);Ee(q,{class:"text-yellow-800",children:(Y,K)=>{T();var D=M("Project Not Found");t(Y,D)},$$slots:{default:!0}});var X=c(q,2);Be(X,{class:"text-yellow-600 pt-2",children:(Y,K)=>{T();var D=M();P(()=>F(D,`The project "${u()??""}" could not be found.`)),t(Y,D)},$$slots:{default:!0}}),t(G,L)},$$slots:{default:!0}});var Q=c(w,2);Oe(Q,{class:"flex justify-end",children:(G,z)=>{Ie(G,{variant:"outline",class:"border-yellow-200 text-yellow-800 hover:bg-yellow-100",$$events:{click:()=>window.location.href="/"},children:(L,q)=>{T();var X=M("Go Back");t(L,X)},$$slots:{default:!0}})},$$slots:{default:!0}}),t(V,E)},$$slots:{default:!0}}),o($),t(d,$)},d=>{var $=Ct(),U=s($),V=n(U),ne=n(V,!0);o(V);var E=c(V,2);ht(E,{reloadRecentRuns:W}),o(U);var w=c(U,2);pt(w,{});var Q=c(w,2),G=n(Q);fe(G,{children:(q,X)=>{Ae(q,{class:"flex items-center justify-between py-4",children:(Y,K)=>{var D=Dt(),ie=c(s(D),2),ce=n(ie,!0);o(ie),P(()=>F(ce,b(B))),t(Y,D)},$$slots:{default:!0}})},$$slots:{default:!0}}),o(Q);var z=c(Q,2);Qe(z,{get runsList(){return b(A)},get isLoading(){return b(I)},get loadingError(){return b(g)},showViewAll:!0});var L=c(z,2);jt(L,{alerts:le}),P(()=>F(ne,b(m).name)),t(d,$)},!0),t(N,i)},!0),t(_,j)}),o(J),t(h,J),oe()}export{Vt as component};
